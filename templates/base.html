<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RocKaRan Cat Farm</title>

    <!-- Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'beige': '#F5F5DC',
                        'warm-beige': '#F0E8D8',
                        'soft-gray': '#E5E5E5',
                        'dusty-rose': '#D4A4A4',
                        'muted-pink': '#E8D5D5'
                    }
                }
            }
        }
    </script>

    <!-- Alpine.js Store (replace your existing store) -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.store('carousel', {
                images: [
                    "https://images.unsplash.com/photo-1519052537078-e6302a4968d4?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1518791841217-8f162f1e1131?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1472491235688-bdc81a63246e?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1541781774459-bb2af2f05b55?auto=format&fit=crop&w=800&q=80"
                ],
                active: 0,
                isMobile: false,
                autoPlayInterval: null,
                extendedImages: [],
                isTransitioning: false,
                currentPosition: 1,
                init() {
                    this.checkScreenSize();
                    this.createExtendedImages();
                    window.addEventListener('resize', () => {
                        this.checkScreenSize();
                        this.updateCarousel();
                    });
                    this.updateCarousel();
                    this.startAutoPlay();
                },
                createExtendedImages() {
                    // Create extended loop for perfect infinite scroll
                    this.extendedImages = [
                        this.images[this.images.length - 2], // Second to last
                        this.images[this.images.length - 1], // Last image
                        ...this.images,                      // All original images
                        this.images[0],                      // First image
                        this.images[1]                       // Second image
                    ];
                    this.currentPosition = 2; // Start at first real image (index 2 in extended array)
                },
                checkScreenSize() {
                    this.isMobile = window.innerWidth < 768;
                },
                next() {
                    if (this.isTransitioning) return;
                    this.isTransitioning = true;

                    this.stopAutoPlay();
                    this.startAutoPlay();

                    this.currentPosition++;
                    this.active = (this.active + 1) % this.images.length;
                    this.updateCarousel();

                    // Check if we need to reset (after showing first duplicate)
                    if (this.currentPosition >= this.images.length + 2) {
                        setTimeout(() => {
                            this.currentPosition = 2; // Reset to first real image
                            this.updateCarousel(false);
                            setTimeout(() => this.isTransitioning = false, 20);
                        }, 500);
                    } else {
                        setTimeout(() => this.isTransitioning = false, 500);
                    }
                },
                prev() {
                    if (this.isTransitioning) return;
                    this.isTransitioning = true;

                    this.stopAutoPlay();
                    this.startAutoPlay();

                    this.currentPosition--;
                    this.active = this.active === 0 ? this.images.length - 1 : this.active - 1;
                    this.updateCarousel();

                    // Check if we need to reset (after showing last duplicate)
                    if (this.currentPosition < 2) {
                        setTimeout(() => {
                            this.currentPosition = this.images.length + 1; // Reset to last real image
                            this.updateCarousel(false);
                            setTimeout(() => this.isTransitioning = false, 20);
                        }, 500);
                    } else {
                        setTimeout(() => this.isTransitioning = false, 500);
                    }
                },
                goToSlide(index) {
                    if (this.isTransitioning) return;

                    this.stopAutoPlay();
                    this.startAutoPlay();

                    this.active = index;
                    this.currentPosition = index + 2; // +2 because of the two prefix images
                    this.updateCarousel();
                },
                startAutoPlay() {
                    this.stopAutoPlay();
                    this.autoPlayInterval = setInterval(() => {
                        this.autoNext();
                    }, 6000);
                },
                autoNext() {
                    if (this.isTransitioning) return;
                    this.isTransitioning = true;

                    this.currentPosition++;
                    this.active = (this.active + 1) % this.images.length;
                    this.updateCarousel();

                    if (this.currentPosition >= this.images.length + 2) {
                        setTimeout(() => {
                            this.currentPosition = 2;
                            this.updateCarousel(false);
                            setTimeout(() => this.isTransitioning = false, 20);
                        }, 500);
                    } else {
                        setTimeout(() => this.isTransitioning = false, 500);
                    }
                },
                stopAutoPlay() {
                    if (this.autoPlayInterval) {
                        clearInterval(this.autoPlayInterval);
                        this.autoPlayInterval = null;
                    }
                },
                updateCarousel(withTransition = true) {
                    const carousel = this.$refs.carousel;
                    if (!carousel) return;

                    if (this.isMobile) {
                        const offset = this.active * -100;
                        carousel.style.transition = withTransition ? 'transform 0.5s ease-out' : 'none';
                        carousel.style.transform = `translateX(${offset}%)`;
                    } else {
                        const containerWidth = carousel.parentElement.offsetWidth;
                        const imageWidth = 400;
                        const gap = 60;

                        const centerPosition = (containerWidth - imageWidth) / 2;
                        const slideDistance = imageWidth + gap;
                        const offset = centerPosition - (this.currentPosition * slideDistance);

                        carousel.style.transition = withTransition ? 'transform 0.5s ease-out' : 'none';
                        carousel.style.transform = `translateX(${offset}px)`;
                    }
                },
                // Helper function to determine if image should be highlighted
                isActiveImage(index) {
                    return index === this.currentPosition;
                }
            });
        });
    </script>

    <!-- Alpine.js from CDN -->
    <script defer src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js"></script>
</head>
<body class="bg-beige">
    <!-- Navigation bar -->
    <!-- Replace your nav with this CSS-only version -->
    <nav class="bg-warm-beige border-b border-soft-gray p-4">
        <div class="container mx-auto px-4 lg:px-16">
            <div class="flex justify-between items-center">
                <!-- Logo and title -->
                <div class="flex items-center space-x-3">
                    <img src="/static/images/logo.png" alt="RocKaRan Logo" class="h-10 w-10 rounded-full">
                    <h1 class="text-xl font-bold text-black">RocKaRan Cat Farm</h1>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex space-x-6">
                    <a href="/" class="text-black hover:text-dusty-rose transition-colors">Home</a>
                    <a href="/cats" class="text-black hover:text-dusty-rose transition-colors">Cats</a>
                    <a href="/news" class="text-black hover:text-dusty-rose transition-colors">News</a>
                </div>

                <!-- Simple mobile menu (dropdown style) -->
                <div class="md:hidden relative">
                    <input type="checkbox" id="mobile-menu-toggle" class="hidden">
                    <label for="mobile-menu-toggle" class="cursor-pointer">
                        <div class="w-6 h-6 flex flex-col justify-center items-center">
                            <div class="w-5 h-0.5 bg-black"></div>
                            <div class="w-5 h-0.5 bg-black mt-1"></div>
                            <div class="w-5 h-0.5 bg-black mt-1"></div>
                        </div>
                    </label>

                    <!-- Mobile dropdown (hidden by default) -->
                    <div class="absolute right-0 top-8 hidden bg-warm-beige border border-soft-gray rounded-lg shadow-lg p-4 z-50" id="mobile-menu">
                        <div class="flex flex-col space-y-3 min-w-32">
                            <a href="/" class="text-black hover:text-dusty-rose transition-colors">üè† Home</a>
                            <a href="/cats" class="text-black hover:text-dusty-rose transition-colors">üê± Cats</a>
                            <a href="/news" class="text-black hover:text-dusty-rose transition-colors">üì∞ News</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <style>
        #mobile-menu-toggle:checked + label + #mobile-menu {
            display: block !important;
        }
    </style>

    <!-- Main content area -->
    <main class="container mx-auto p-6">
        {% block content %}
        <!-- Page content goes here -->
        {% endblock %}
    </main>
</body>
</html>
