<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RocKaRan Cat Farm</title>

    <!-- Tailwind CSS from CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Custom colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'beige': '#F5F5DC',
                        'warm-beige': '#F0E8D8',
                        'soft-gray': '#E5E5E5',
                        'dusty-rose': '#D4A4A4',
                        'muted-pink': '#E8D5D5'
                    }
                }
            }
        }
    </script>

    <!-- Alpine.js Store - ONLY replace the updateCarousel function -->
    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.store('carousel', {
                images: [
                    "https://images.unsplash.com/photo-1519052537078-e6302a4968d4?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1514888286974-6c03e2ca1dba?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1518791841217-8f162f1e1131?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1472491235688-bdc81a63246e?auto=format&fit=crop&w=800&q=80",
                    "https://images.unsplash.com/photo-1541781774459-bb2af2f05b55?auto=format&fit=crop&w=800&q=80"
                ],
                active: 0,
                isMobile: false,
                autoPlayInterval: null,
                virtualIndex: 100, // Start at virtual position 100 (middle of infinite strip)

                init() {
                    this.checkScreenSize();
                    this.updateCarousel();
                    window.addEventListener('resize', () => {
                        this.checkScreenSize();
                        this.updateCarousel();
                    });
                    this.startAutoPlay();
                },

                checkScreenSize() {
                    this.isMobile = window.innerWidth < 768;
                },

                next() {
                    this.stopAutoPlay();
                    this.startAutoPlay();

                    // Always move forward in virtual space
                    this.virtualIndex++;
                    this.active = (this.active + 1) % this.images.length;
                    this.updateCarousel();
                },

                prev() {
                    this.stopAutoPlay();
                    this.startAutoPlay();

                    // Always move backward in virtual space
                    this.virtualIndex--;
                    this.active = this.active === 0 ? this.images.length - 1 : this.active - 1;
                    this.updateCarousel();
                },

                goToSlide(index) {
                    this.stopAutoPlay();
                    this.startAutoPlay();

                    this.active = index;
                    this.updateCarousel();
                },

                updateCarousel() {
                    const carousel = this.$refs.carousel;
                    if (!carousel) return;

                    if (this.isMobile) {
                        // Mobile: use virtualIndex for infinite scroll (keep as is)
                        const containerWidth = carousel.parentElement.offsetWidth;
                        const offset = this.virtualIndex * -containerWidth;
                        carousel.style.transition = 'transform 0.5s ease-out';
                        carousel.style.transform = `translateX(${offset}px)`;
                    } else {
                        // Desktop: ALWAYS center active image perfectly
                        const containerWidth = carousel.parentElement.offsetWidth;
                        const imageWidth = 400;
                        const gap = 60;
                        const slideWidth = imageWidth + gap;

                        // Perfect center calculation - active image ALWAYS in exact center
                        const exactCenter = containerWidth / 2;
                        const imageCenterOffset = imageWidth / 2;
                        const perfectCenterPosition = exactCenter - imageCenterOffset;

                        // Calculate offset to center the active image (virtualIndex position)
                        const offset = perfectCenterPosition - (this.virtualIndex * slideWidth);

                        carousel.style.transition = 'transform 0.5s ease-out';
                        carousel.style.transform = `translateX(${offset}px)`;
                    }
                },

                startAutoPlay() {
                    this.stopAutoPlay();
                    this.autoPlayInterval = setInterval(() => {
                        this.next();
                    }, 6000);
                },

                stopAutoPlay() {
                    if (this.autoPlayInterval) {
                        clearInterval(this.autoPlayInterval);
                        this.autoPlayInterval = null;
                    }
                },

                // Create a large infinite array for true endless scroll
                getInfiniteImages() {
                    const repeats = 50; // Create 50 copies (250 images total)
                    const infiniteArray = [];
                    for (let i = 0; i < repeats; i++) {
                        infiniteArray.push(...this.images);
                    }
                    return infiniteArray;
                },

                isActiveImage(index) {
                    // Check if this image represents the currently active image
                    return index % this.images.length === this.active;
                }
            });
        });
    </script>

    <!-- Alpine.js from CDN -->
    <script defer src="https://unpkg.com/alpinejs@3.13.3/dist/cdn.min.js"></script>
</head>
<body class="bg-beige">
    <!-- Navigation bar -->
    <!-- Replace your nav with this CSS-only version -->
    <nav class="bg-warm-beige border-b border-soft-gray p-4">
        <div class="container mx-auto px-4 lg:px-16">
            <div class="flex justify-between items-center">
                <!-- Logo and title -->
                <div class="flex items-center space-x-3">
                    <img src="/static/images/logo.png" alt="RocKaRan Logo" class="h-10 w-10 rounded-full">
                    <h1 class="text-xl font-bold text-black">RocKaRan Cat Farm</h1>
                </div>

                <!-- Desktop Navigation -->
                <div class="hidden md:flex space-x-6">
                    <a href="/" class="text-black hover:text-dusty-rose transition-colors">Home</a>
                    <a href="/cats" class="text-black hover:text-dusty-rose transition-colors">Cats</a>
                    <a href="/news" class="text-black hover:text-dusty-rose transition-colors">News</a>
                </div>

                <!-- Simple mobile menu (dropdown style) -->
                <div class="md:hidden relative">
                    <input type="checkbox" id="mobile-menu-toggle" class="hidden">
                    <label for="mobile-menu-toggle" class="cursor-pointer">
                        <div class="w-6 h-6 flex flex-col justify-center items-center">
                            <div class="w-5 h-0.5 bg-black"></div>
                            <div class="w-5 h-0.5 bg-black mt-1"></div>
                            <div class="w-5 h-0.5 bg-black mt-1"></div>
                        </div>
                    </label>

                    <!-- Mobile dropdown (hidden by default) -->
                    <div class="absolute right-0 top-8 hidden bg-warm-beige border border-soft-gray rounded-lg shadow-lg p-4 z-50" id="mobile-menu">
                        <div class="flex flex-col space-y-3 min-w-32">
                            <a href="/" class="text-black hover:text-dusty-rose transition-colors">üè† Home</a>
                            <a href="/cats" class="text-black hover:text-dusty-rose transition-colors">üê± Cats</a>
                            <a href="/news" class="text-black hover:text-dusty-rose transition-colors">üì∞ News</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <style>
        #mobile-menu-toggle:checked + label + #mobile-menu {
            display: block !important;
        }
    </style>

    <!-- Main content area -->
    <main class="container mx-auto p-6">
        {% block content %}
        <!-- Page content goes here -->
        {% endblock %}
    </main>
</body>
</html>
